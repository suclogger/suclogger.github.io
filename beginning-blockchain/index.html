<!DOCTYPE html>






  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















  

<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.2/css/font-awesome.min.css" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.2.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.2.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.2.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.2.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.2.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '6.2.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="初识区块链。">
<meta name="keywords" content="blockchain">
<meta property="og:type" content="article">
<meta property="og:title" content="初识区块链">
<meta property="og:url" content="https://suclogger.me/beginning-blockchain/index.html">
<meta property="og:site_name" content="Suclogger">
<meta property="og:description" content="初识区块链。">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://suclogger.me/image/2018-08-15/2018-08-15-22-11-26.jpg">
<meta property="og:image" content="https://suclogger.me/image/2018-08-15/2018-08-15-22-43-47.jpg">
<meta property="og:image" content="https://suclogger.me/image/2018-08-15/2018-08-15-22-26-15.jpg">
<meta property="og:image" content="https://suclogger.me/image/2018-08-15/Beginning%20Blockchain%202018-08-15%2022-23-53.png">
<meta property="og:image" content="https://suclogger.me/image/2018-08-15/2018-08-15-22-24-47.jpg">
<meta property="og:image" content="https://suclogger.me/image/2018-08-15/2018-08-15-23-09-03.jpg">
<meta property="og:image" content="https://suclogger.me/image/2018-08-15/2018-08-15-23-05-12.jpg">
<meta property="og:image" content="https://suclogger.me/image/2018-08-15/2018-08-15-23-05-23.jpg">
<meta property="og:image" content="https://suclogger.me/image/2018-08-15/2018-08-15-23-15-42.jpg">
<meta property="og:image" content="https://suclogger.me/image/2018-08-15/2018-08-15-23-17-57.jpg">
<meta property="og:image" content="https://suclogger.me/image/2018-08-15/2018-08-15-23-00-20.jpg">
<meta property="og:image" content="https://suclogger.me/image/2018-08-15/2018-08-15-23-28-16.jpg">
<meta property="og:image" content="https://suclogger.me/image/2018-08-15/2018-08-15-23-24-05.jpg">
<meta property="og:image" content="https://suclogger.me/image/2018-08-15/2018-08-15-23-36-42.jpg">
<meta property="og:image" content="https://suclogger.me/image/2018-08-15/2018-08-15-23-45-25.jpg">
<meta property="og:image" content="https://suclogger.me/image/2018-08-15/2018-08-15-23-50-19.jpg">
<meta property="og:image" content="https://suclogger.me/image/2018-08-15/2018-08-16-01-19-04.jpg">
<meta property="og:image" content="https://suclogger.me/image/2018-08-15/2018-08-16-01-32-58.jpg">
<meta property="og:image" content="https://suclogger.me/image/2018-08-15/2018-08-16-02-17-49.jpg">
<meta property="og:updated_time" content="2018-08-16T05:27:56.535Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="初识区块链">
<meta name="twitter:description" content="初识区块链。">
<meta name="twitter:image" content="https://suclogger.me/image/2018-08-15/2018-08-15-22-11-26.jpg">






  <link rel="canonical" href="https://suclogger.me/beginning-blockchain/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>初识区块链 | Suclogger</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Suclogger</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">莆放</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>




<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">
    <a href="/" rel="section">Home</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">Archives</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">
    <a href="/categories" rel="section">Categories</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
    <a href="/tags" rel="section">Tags</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-about">
    <a href="/about" rel="section">About</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-sitemap">
    <a href="/sitemap.xml" rel="section">Sitemap</a>
  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://suclogger.me/beginning-blockchain/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Suclogger">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Suclogger">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">初识区块链
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-08-15 10:31:31" itemprop="dateCreated datePublished" datetime="2018-08-15T10:31:31+08:00">2018-08-15</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2018-08-16 13:27:56" itemprop="dateModified" datetime="2018-08-16T13:27:56+08:00">2018-08-16</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/blockchain/" itemprop="url" rel="index"><span itemprop="name">blockchain</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/beginning-blockchain/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="beginning-blockchain/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>初识区块链。<br><a id="more"></a></p>
<h2 id="为何关注区块链？"><a href="#为何关注区块链？" class="headerlink" title="为何关注区块链？"></a>为何关注区块链？</h2><p><a href="https://mp.weixin.qq.com/s/X38YbpdMGF5svtghwwBI0Q" target="_blank" rel="noopener">我是怎么入坑的 朱赟</a><br><a href="https://time.geekbang.org/column/article/12458" target="_blank" rel="noopener">区块链技术人才现状：供给严重不足</a></p>
<blockquote>
<p>我对区块链的评价是这样的，一场乌托邦实验，从最终来看，所谓革命不过是一厢情愿。<br>但是，但是即便是乌托邦实验，时间窗口也可以维持足够长，想想德国人的某某主义都一百多年了还有人信不是吗，所以，至少十年，甚至更长，这个产业的饭碗是有的。 – CaoZ</p>
</blockquote>
<hr>
<p>正经的笼统介绍：</p>
<ol>
<li>区块链实现了了无需依赖可信第三方的点对点价值交换。</li>
<li>分布式，去中心化和开放的账本，账本的数据同时分布在多个节点上。</li>
<li>账本数据只能添加，不能修改。每个交易一旦发生即被持久地保存到所有节点上。</li>
<li>无需可信的第三方来保障交易的有效性，安全性以及最终交易的最终确认。</li>
<li>与其他以太网应用共存。</li>
<li>正如TCP/IP协议被设计为创造开放的互联网环境，区块链被设计为创造去中心化的信任环境。</li>
</ol>
<p>一个典型的区块链如图：<br><img src="/image/2018-08-15/2018-08-15-22-11-26.jpg" alt=""></p>
<p>一个极简的区块链实现：<a href="https://github.com/Jeiwan/blockchain_go" target="_blank" rel="noopener">blockchain_go</a></p>
<h2 id="区块链核心技术"><a href="#区块链核心技术" class="headerlink" title="区块链核心技术"></a>区块链核心技术</h2><p><strong>区块链并非是一种颠覆式技术，而是多种技术的集成式创新</strong></p>
<p><img src="/image/2018-08-15/2018-08-15-22-43-47.jpg" alt=""></p>
<p>类比TCP/IP协议的分层架构设计，不同区块链的设计一般也包含以下层次：</p>
<p><img src="/image/2018-08-15/2018-08-15-22-26-15.jpg" alt=""></p>
<hr>
<p>一个中心化的系统：</p>
<p><img src="/image/2018-08-15/Beginning Blockchain 2018-08-15 22-23-53.png" alt=""></p>
<p>一个去中心化的系统：<br><img src="/image/2018-08-15/2018-08-15-22-24-47.jpg" alt=""></p>
<h3 id="密码学"><a href="#密码学" class="headerlink" title="密码学"></a>密码学</h3><p>区块链主要借助密码学提供的几个特性：</p>
<ul>
<li>保密性（Confidentiality）</li>
<li>完整性（Data Integrity）</li>
<li>身份认证（Authentication）</li>
<li>不可否认性（Non-repudiation）</li>
</ul>
<blockquote>
<p>想象一个场景，我给文拓寄出了一个顺丰快递，我如何保障这个快递没有被别人获知内容，而且内容没有被掉包？文拓又如何确认这是我寄出的包裹？如果我否认寄出过这个包裹，他如何举证？</p>
</blockquote>
<h4 id="对称加密：可靠信道"><a href="#对称加密：可靠信道" class="headerlink" title="对称加密：可靠信道"></a>对称加密：可靠信道</h4><p>常用实现：AES</p>
<p><img src="/image/2018-08-15/2018-08-15-23-09-03.jpg" alt=""></p>
<p>缺点：</p>
<ul>
<li>密钥需要通过可靠信道预先协商</li>
<li>发送方和接收方必须都是诚实可信的</li>
<li>在一个多节点网络中，实现安全通信需要n(n–1)/2数量的密钥</li>
</ul>
<h4 id="非对称加密：公钥公开"><a href="#非对称加密：公钥公开" class="headerlink" title="非对称加密：公钥公开"></a>非对称加密：公钥公开</h4><p>常用实现：RSA</p>
<ul>
<li>公钥公开，所有人都可以获取，用于内容加密或者验签</li>
<li>私钥需要妥善保管，用于内容解密或者创建签名</li>
</ul>
<h5 id="公钥加密的场景：加密通信"><a href="#公钥加密的场景：加密通信" class="headerlink" title="公钥加密的场景：加密通信"></a>公钥加密的场景：加密通信</h5><p><img src="/image/2018-08-15/2018-08-15-23-05-12.jpg" alt=""></p>
<h5 id="私钥加密的场景：身份认证"><a href="#私钥加密的场景：身份认证" class="headerlink" title="私钥加密的场景：身份认证"></a>私钥加密的场景：身份认证</h5><p><img src="/image/2018-08-15/2018-08-15-23-05-23.jpg" alt=""></p>
<p>在多节点加密通信中需要的密钥数量对比：<br><img src="/image/2018-08-15/2018-08-15-23-15-42.jpg" alt=""></p>
<h4 id="HASH"><a href="#HASH" class="headerlink" title="HASH"></a>HASH</h4><p><img src="/image/2018-08-15/2018-08-15-23-17-57.jpg" alt=""><br>常用实现：HMACs，SHA512</p>
<ul>
<li>校验数据完整性</li>
<li>建立索引</li>
<li>可重放</li>
<li>不可逆</li>
</ul>
<h4 id="应用：计算机通信领域的HTTPS加密通道设计"><a href="#应用：计算机通信领域的HTTPS加密通道设计" class="headerlink" title="应用：计算机通信领域的HTTPS加密通道设计"></a>应用：计算机通信领域的HTTPS加密通道设计</h4><p><img src="/image/2018-08-15/2018-08-15-23-00-20.jpg" alt=""></p>
<h4 id="区块链应用"><a href="#区块链应用" class="headerlink" title="区块链应用"></a>区块链应用</h4><h5 id="身份认证"><a href="#身份认证" class="headerlink" title="身份认证"></a>身份认证</h5><p>Bitcoin通过独有的一对非对称密钥来表明身份。公钥用于收款，私钥用于花钱。</p>
<p><img src="/image/2018-08-15/2018-08-15-23-28-16.jpg" alt=""></p>
<p>Bitcoin钱包地址生成策略：</p>
<p><img src="/image/2018-08-15/2018-08-15-23-24-05.jpg" alt=""></p>
<p>一个典型的以太坊发起交易的代码示例：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> tx = &#123;</span><br><span class="line">    <span class="keyword">from</span>: <span class="string">"0xb31FCEF59493cd3f39a41A311Df42AaDd7a5079e"</span>,</span><br><span class="line">    gasPricde: <span class="string">"2000000000"</span>,</span><br><span class="line">    gas: <span class="string">"42000"</span>,</span><br><span class="line">    <span class="comment">// 使用公钥作为目标地址</span></span><br><span class="line">    to: <span class="string">"0x8D08b0bBE8B3Aab4aE4B00eB15fE53C442f9DE47"</span>,</span><br><span class="line">    value: <span class="string">"500000000000000000"</span>,</span><br><span class="line">    data: <span class="string">""</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 使用私钥签署交易</span></span><br><span class="line">web3.eth.accounts.signTransaction(tx, <span class="string">'0x81adb7a5b3df9eb15221610954cb3c8e626556afd0fb466b8a6335aa561bbdbe'</span>).then(<span class="function"><span class="keyword">function</span>(<span class="params">signedTx</span>) </span>&#123;</span><br><span class="line">    web3.eth.sendSignedTransaction(signedTx.rawTransaction).then(<span class="built_in">console</span>.log);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h5 id="数据校验，交易查找"><a href="#数据校验，交易查找" class="headerlink" title="数据校验，交易查找"></a>数据校验，交易查找</h5><p>UTXO的HASH作为交易的起点：（transaction input中）<br><img src="/image/2018-08-15/2018-08-15-23-36-42.jpg" alt=""></p>
<p>一个Bitcoin上的交易如：<a href="https://blockchain.info/tx/b657e22827039461a9493ede7bdf55b01579254c1630b0bfc9185ec564fc05ab?format=json" target="_blank" rel="noopener">举个栗子</a></p>
<p>Block的HASH指向上一个Block：（block header中）<br><img src="/image/2018-08-15/2018-08-15-23-45-25.jpg" alt=""></p>
<p>Merkle Trees通过HASH确保Block中的每个交易都不可被篡改：<br><img src="/image/2018-08-15/2018-08-15-23-50-19.jpg" alt=""></p>
<h3 id="分布式共识"><a href="#分布式共识" class="headerlink" title="分布式共识"></a>分布式共识</h3><p>之前写过两篇相关的文章：<a href="https://suclogger.me/分布式系统设计迷思">分布式系统设计迷思</a> 和 <a href="https://suclogger.me/分布式系统设计迷思（二）">分布式系统设计迷思（二）</a>  ，感兴趣的童鞋可以看看。</p>
<p>Paxos协议可以完美的解决在一个<strong>可信环境</strong>中的共识问题。<br>然而区块链技术本身就是要实现一个分布式的信任机制，显然采用Paxos是个循环证明。如何达成<code>共识</code>的命题在这样一个分布式的，缺乏信任（相对于有可信第三方做中间人）的环境中显得尤为重要，因为随时有敌人或者竞争对手试图篡改你的数据，因而我们每当要将一个区块持久化之前，必须要一个适当的机制来进行校验。<strong>共识是商定确定性交易顺序和过滤无效交易的过程。</strong></p>
<blockquote>
<p>在古代，一些拜占庭的将军率领他们的部队要攻占敌人的一个城池, 每个将军只能控制他们自己的部队并且通过信使传递消息给其他的将军(这条消息只有参与的两个将军知道，其他的将军可以打听，但是不能验证消息的正确性)。如果这些将军中有些是来自敌方的奸细，那么如何使忠诚的将军仍然可以达成行动协议而不受奸细的挑拨，就是拜占庭将军问题。分布式系统的每一个节点可以类比成将军，服务器之间的消息传递可以类比成信使，服务器可能会发生错误而产生错误的信息传达给其他服务器。因此拜占庭容错系统是指：在一个拥有n台服务器的系统中，整个系统对于每一个请求需满足以下两个条件：</p>
<ol>
<li>所有非拜占庭服务器使用相同的输入信息，产生一致的结果；</li>
<li>如果输入的信息正确，那么所有非拜占庭服务器必须接受这个信息，并计算相应的结果。</li>
</ol>
</blockquote>
<p>在一个拜占庭容错系统下达成共识一般有以下方法：</p>
<ol>
<li>PBFT（the practical byzantine fault tolerance algorithm）</li>
<li>PoW（the proof-of-work algorithm）</li>
<li>PoS（the proof-of-stake algorithm）</li>
<li>DPoS（the delegated proof-of-stake algorithm）</li>
</ol>
<h4 id="PBFT"><a href="#PBFT" class="headerlink" title="PBFT"></a>PBFT</h4><p>采用PBFT作为共识机制的区块链实现有：Ripple，Hyperledger，Stellar等。<br>简而言之，PBFT在每一轮中，每个将军基于自己的判断做出决定，收到别的将军的决定后，与自己的决定做某些比较和计算，两两交互之后可以在一定数量叛徒的情况下得出正确共识（3f+1个节点可以容忍拜占庭服务器不超过f个）</p>
<p><img src="/image/2018-08-15/2018-08-16-01-19-04.jpg" alt=""></p>
<p>这是几种方法中代价最小的一种方法 ，但是他要求每个参与者对他的表决签名，因而牺牲了参与者的匿名性。</p>
<h4 id="PoW"><a href="#PoW" class="headerlink" title="PoW"></a>PoW</h4><p>这个恐怕是最有名的共识方法了，也是Bitcoin采用的共识方法。工作量证明的关键特点就是，分布式系统中的请求服务的节点必须解决一个一般难度但是可行（feasible）的问题，但是验证问题答案的过程对于服务提供者来说却非常容易，也就是一个不容易解答但是容易验证的问题。<br>PoW基于Hash的不可逆特性（想要通过 SHA-256 函数的输出推断出输入在目前来看可能性是可以忽略不计的），允许参与者提交自己的计算结果（Nonce），成功提交正确计算结果（Nonce）的节点会得到奖励，因为他确实付出了相应的计算资源。由于Hash函数的特性，获取Nonce除了遍历别无他法，这个遍历Nonce计算满足难度目标的过程就被成为挖矿。</p>
<p><img src="/image/2018-08-15/2018-08-16-01-32-58.jpg" alt=""></p>
<blockquote>
<p>为什么可以避免成果被窃取？</p>
</blockquote>
<p>由于工作量证明需要消耗大量的算力，同时比特币大约 10min 才会产生一个区块，区块的大小也只有 1MB，仅仅能够包含 3、4000 笔交易，平均下来每秒只能够处理 5~7（个位数）笔交易，所以比特币网络的拥堵状况非常严重，也催生了Off-Chain计算和Lightning Network等概念。</p>
<h4 id="PoS"><a href="#PoS" class="headerlink" title="PoS"></a>PoS</h4><p>PoS用一个数字签名代替了PoW中的hash函数，这个数字签名代表对应的担保资产。即用已有的币挖矿。<br>简单来说，就是一个根据你持有货币的量和时间，给你发利息的一个制度，在股权证明POS模式下，有一个名词叫币龄，每个币每天产生1币龄，比如你持有100个币，总共持有了30天，那么，此时你的币龄就为3000，这个时候，如果你发现了一个POS区块，你的币龄就会被清空为0。你每被清空365币龄，你将会从区块中获得0.05个币的利息(假定利息可理解为年利率5%)，那么在这个案例中，利息 = 3000 * 5% / 365 = 0.41个币。<br>与工作量证明相比，权益证明不需要消耗大量的电力就能够保证区块链网络的安全性，同时也不需要在每个区块中创建新的货币来激励矿工参与当前网络的运行，这也就在一定程度上缩短了达成共识所需要的时间。<br>由于整个网络只会奖励创建区块的节点，不存在任何惩罚，即便是诚实节点，如果它足够理性，那么它也会在所有它收到的链上同时挖矿。POW里，没人挖的分支很快就会变成孤块被丢弃，但在POS里，如果整个网络足够理性，会出现的情况反而是每条分支都会永远存在因为理性的矿工会同时在所有分支上挖矿。如果只用最长链共识的话，POS本身是没法应对分叉的，必须通过惩罚。总而言之就是通过算法之外的事情解决这个问题，引入激励和惩罚。</p>
<p>更多资料参考：<a href="https://github.com/ethereum/wiki/wiki/Proof-of-Stake-FAQs" target="_blank" rel="noopener">Proof of Stake FAQs</a></p>
<h4 id="DPoS"><a href="#DPoS" class="headerlink" title="DPoS"></a>DPoS</h4><p>在DPoS中，每个节点都可以投票选出自己的代理节点参与生成新区块的争夺，得票最多的前 N 个节点会被选择成为区块的创建者，下一个区块的创建者就会从这样一组当选者中随机选取。这就避免了PoS中拥有少数资产的节点没有话语权的问题，而且网络中进行新区块创建争夺的节点越少，网络的处理能力就会越强，性能就会越快。使用委托权益证明的 EOS 能够每秒处理几十万笔交易。</p>
<p><img src="/image/2018-08-15/2018-08-16-02-17-49.jpg" alt=""></p>
<p>更多资料参考：<a href="https://steemit.com/dpos/@legendx/dpos" target="_blank" rel="noopener">DPOS共识算法 – 缺失的白皮书</a></p>
<h2 id="基于以太坊开发一个简单的DApp：选举"><a href="#基于以太坊开发一个简单的DApp：选举" class="headerlink" title="基于以太坊开发一个简单的DApp：选举"></a>基于以太坊开发一个简单的DApp：选举</h2><h3 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h3><ol>
<li>准备node环境</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install node</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>安装Truffle</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g truffle</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>安装Ganache</li>
</ol>
<p>从<a href="https://truffleframework.com/ganache" target="_blank" rel="noopener">ganache官网</a>下载安装包安装</p>
<ol start="4">
<li>安装chrome扩展：Meta-Mask</li>
</ol>
<h3 id="Coding"><a href="#Coding" class="headerlink" title="Coding"></a>Coding</h3><h4 id="1-初始化示例项目pet-shop"><a href="#1-初始化示例项目pet-shop" class="headerlink" title="1. 初始化示例项目pet-shop"></a>1. 初始化示例项目pet-shop</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">truffle unbox pet-shop</span><br></pre></td></tr></table></figure>
<p>初始化后包含以下目录结构：<br><code>contracts/</code> 智能合约的文件夹，所有的智能合约文件都放置在这里，里面包含一个重要的合约Migrations.sol<br><code>migrations/</code> 用来处理部署（迁移）智能合约 ，迁移是一个额外特别的合约用来保存合约的变化。<br><code>test/</code> 智能合约测试用例文件夹<br><code>truffle.js/</code> 配置文件</p>
<h4 id="2-编写智能合约"><a href="#2-编写智能合约" class="headerlink" title="2. 编写智能合约"></a>2. 编写智能合约</h4><p>在<code>contracts</code>目录下添加<code>Election.sol</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity ^0.4.2;</span><br><span class="line"></span><br><span class="line">contract Election &#123;</span><br><span class="line">    // Model a Candidate</span><br><span class="line">    struct Candidate &#123;</span><br><span class="line">        uint id;</span><br><span class="line">        string name;</span><br><span class="line">        uint voteCount;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // Store accounts that have voted</span><br><span class="line">    mapping(address =&gt; bool) public voters;</span><br><span class="line">    // Store Candidates</span><br><span class="line">    // Fetch Candidate</span><br><span class="line">    mapping(uint =&gt; Candidate) public candidates;</span><br><span class="line">    // Store Candidates Count</span><br><span class="line">    uint public candidatesCount;</span><br><span class="line"></span><br><span class="line">    function Election () public &#123;</span><br><span class="line">        addCandidate(&quot;Candidate 1&quot;);</span><br><span class="line">        addCandidate(&quot;Candidate 2&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function addCandidate (string _name) private &#123;</span><br><span class="line">        candidatesCount ++;</span><br><span class="line">        candidates[candidatesCount] = Candidate(candidatesCount, _name, 0);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function vote (uint _candidateId) public &#123;</span><br><span class="line">        // require that they haven&apos;t voted before</span><br><span class="line">        require(!voters[msg.sender]);</span><br><span class="line"></span><br><span class="line">        // require a valid candidate</span><br><span class="line">        require(_candidateId &gt; 0 &amp;&amp; _candidateId &lt;= candidatesCount);</span><br><span class="line"></span><br><span class="line">        // record that voter has voted</span><br><span class="line">        voters[msg.sender] = true;</span><br><span class="line"></span><br><span class="line">        // update candidate vote Count</span><br><span class="line">        candidates[_candidateId].voteCount ++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="3-编译和准备部署脚本"><a href="#3-编译和准备部署脚本" class="headerlink" title="3. 编译和准备部署脚本"></a>3. 编译和准备部署脚本</h4><p>通过以下命令编译：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">truffle compile</span><br></pre></td></tr></table></figure>
<p>在<code>migrations</code>目录下添加migrate脚本<code>2_deploy_contracts.js</code>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Election = artifacts.require(<span class="string">"./Election.sol"</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">deployer</span>) </span>&#123;</span><br><span class="line">  deployer.deploy(Election);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="4-创建用户接口和智能合约交互"><a href="#4-创建用户接口和智能合约交互" class="headerlink" title="4. 创建用户接口和智能合约交互"></a>4. 创建用户接口和智能合约交互</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line">App = &#123;</span><br><span class="line">  web3Provider: <span class="literal">null</span>,</span><br><span class="line">  contracts: &#123;&#125;,</span><br><span class="line">  account: <span class="string">'0x0'</span>,</span><br><span class="line">  hasVoted: <span class="literal">false</span>,</span><br><span class="line"></span><br><span class="line">  init: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> App.initWeb3();</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  initWeb3: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// <span class="doctag">TODO:</span> refactor conditional</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> web3 !== <span class="string">'undefined'</span>) &#123;</span><br><span class="line">      <span class="comment">// If a web3 instance is already provided by Meta Mask.</span></span><br><span class="line">      App.web3Provider = web3.currentProvider;</span><br><span class="line">      web3 = <span class="keyword">new</span> Web3(web3.currentProvider);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// Specify default instance if no web3 instance provided</span></span><br><span class="line">      App.web3Provider = <span class="keyword">new</span> Web3.providers.HttpProvider(<span class="string">'http://localhost:7545'</span>);</span><br><span class="line">      web3 = <span class="keyword">new</span> Web3(App.web3Provider);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> App.initContract();</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  initContract: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    $.getJSON(<span class="string">"Election.json"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">election</span>) </span>&#123;</span><br><span class="line">      <span class="comment">// Instantiate a new truffle contract from the artifact</span></span><br><span class="line">      App.contracts.Election = TruffleContract(election);</span><br><span class="line">      <span class="comment">// Connect provider to interact with contract</span></span><br><span class="line">      App.contracts.Election.setProvider(App.web3Provider);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> App.render();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  render: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> electionInstance;</span><br><span class="line">    <span class="keyword">var</span> loader = $(<span class="string">"#loader"</span>);</span><br><span class="line">    <span class="keyword">var</span> content = $(<span class="string">"#content"</span>);</span><br><span class="line"></span><br><span class="line">    loader.show();</span><br><span class="line">    content.hide();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Load account data</span></span><br><span class="line">    web3.eth.getCoinbase(<span class="function"><span class="keyword">function</span>(<span class="params">err, account</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (err === <span class="literal">null</span>) &#123;</span><br><span class="line">        App.account = account;</span><br><span class="line">        $(<span class="string">"#accountAddress"</span>).html(<span class="string">"Your Account: "</span> + account);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Load contract data</span></span><br><span class="line">    App.contracts.Election.deployed().then(<span class="function"><span class="keyword">function</span>(<span class="params">instance</span>) </span>&#123;</span><br><span class="line">      electionInstance = instance;</span><br><span class="line">      <span class="keyword">return</span> electionInstance.candidatesCount();</span><br><span class="line">    &#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">candidatesCount</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> candidatesResults = $(<span class="string">"#candidatesResults"</span>);</span><br><span class="line">      candidatesResults.empty();</span><br><span class="line"></span><br><span class="line">      <span class="keyword">var</span> candidatesSelect = $(<span class="string">'#candidatesSelect'</span>);</span><br><span class="line">      candidatesSelect.empty();</span><br><span class="line"></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt;= candidatesCount; i++) &#123;</span><br><span class="line">        electionInstance.candidates(i).then(<span class="function"><span class="keyword">function</span>(<span class="params">candidate</span>) </span>&#123;</span><br><span class="line">          <span class="keyword">var</span> id = candidate[<span class="number">0</span>];</span><br><span class="line">          <span class="keyword">var</span> name = candidate[<span class="number">1</span>];</span><br><span class="line">          <span class="keyword">var</span> voteCount = candidate[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">          <span class="comment">// Render candidate Result</span></span><br><span class="line">          <span class="keyword">var</span> candidateTemplate = <span class="string">"&lt;tr&gt;&lt;th&gt;"</span> + id + <span class="string">"&lt;/th&gt;&lt;td&gt;"</span> + name + <span class="string">"&lt;/td&gt;&lt;td&gt;"</span> + voteCount + <span class="string">"&lt;/td&gt;&lt;/tr&gt;"</span></span><br><span class="line">          candidatesResults.append(candidateTemplate);</span><br><span class="line"></span><br><span class="line">          <span class="comment">// Render candidate ballot option</span></span><br><span class="line">          <span class="keyword">var</span> candidateOption = <span class="string">"&lt;option value='"</span> + id + <span class="string">"' &gt;"</span> + name + <span class="string">"&lt;/ option&gt;"</span></span><br><span class="line">          candidatesSelect.append(candidateOption);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> electionInstance.voters(App.account);</span><br><span class="line">    &#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">hasVoted</span>) </span>&#123;</span><br><span class="line">      <span class="comment">// Do not allow a user to vote</span></span><br><span class="line">      <span class="keyword">if</span>(hasVoted) &#123;</span><br><span class="line">        $(<span class="string">'form'</span>).hide();</span><br><span class="line">      &#125;</span><br><span class="line">      loader.hide();</span><br><span class="line">      content.show();</span><br><span class="line">    &#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.warn(error);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  castVote: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> candidateId = $(<span class="string">'#candidatesSelect'</span>).val();</span><br><span class="line">    App.contracts.Election.deployed().then(<span class="function"><span class="keyword">function</span>(<span class="params">instance</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> instance.vote(candidateId, &#123; <span class="attr">from</span>: App.account &#125;);</span><br><span class="line">    &#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">result</span>) </span>&#123;</span><br><span class="line">      <span class="comment">// Wait for votes to update</span></span><br><span class="line">      $(<span class="string">"#content"</span>).hide();</span><br><span class="line">      $(<span class="string">"#loader"</span>).show();</span><br><span class="line">    &#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.error(err);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  $(<span class="built_in">window</span>).load(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    App.init();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"IE=edge"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Election Results<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Bootstrap --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"css/bootstrap.min.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- WARNING: Respond.js doesn't work if you view the page via file:// --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--[if lt IE 9]&gt;</span></span><br><span class="line"><span class="comment">      &lt;script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="comment">      &lt;script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="comment">    &lt;![endif]--&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span> <span class="attr">style</span>=<span class="string">"width: 650px;"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-lg-12"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"text-center"</span>&gt;</span>Election Results<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">hr</span>/&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"loader"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"text-center"</span>&gt;</span>Loading...<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"content"</span> <span class="attr">style</span>=<span class="string">"display: none;"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table"</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">th</span> <span class="attr">scope</span>=<span class="string">"col"</span>&gt;</span>#<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">th</span> <span class="attr">scope</span>=<span class="string">"col"</span>&gt;</span>Name<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">th</span> <span class="attr">scope</span>=<span class="string">"col"</span>&gt;</span>Votes<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">tbody</span> <span class="attr">id</span>=<span class="string">"candidatesResults"</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">hr</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">form</span> <span class="attr">onSubmit</span>=<span class="string">"App.castVote(); return false;"</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"candidatesSelect"</span>&gt;</span>Select Candidate<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">select</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"candidatesSelect"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span>Vote<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"accountAddress"</span> <span class="attr">class</span>=<span class="string">"text-center"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- jQuery (necessary for Bootstrap's JavaScript plugins) --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Include all compiled plugins (below), or include individual files as needed --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"js/bootstrap.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"js/web3.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"js/truffle-contract.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"js/app.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="5-部署合约，运行用户界面"><a href="#5-部署合约，运行用户界面" class="headerlink" title="5. 部署合约，运行用户界面"></a>5. 部署合约，运行用户界面</h4><p>通过truffle提供的migrate 命令部署合约：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">truffle migrate</span><br></pre></td></tr></table></figure>
<p>运行node server：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run dev</span><br></pre></td></tr></table></figure>
<p><a href="https://git.dawanju.net/pufang/election" target="_blank" rel="noopener">election</a></p>
<h2 id="推荐阅读"><a href="#推荐阅读" class="headerlink" title="推荐阅读"></a>推荐阅读</h2><p><a href="https://github.com/bitcoinbook/bitcoinbook" target="_blank" rel="noopener">Mastering Bitcoin</a><br><a href="https://bitcoin.org/bitcoin.pdf" target="_blank" rel="noopener">Bitcoin 白皮书</a><br><a href="https://trustsql.qq.com/chain_oss/TrustSQL_WhitePaper.html" target="_blank" rel="noopener">腾讯区块链方案白皮书</a></p>

      
    </div>

    

    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div></div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>Donate</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/image/wechatpay.jpg" alt="Suclogger WeChat Pay"/>
        <p>WeChat Pay</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/image/alipay.png" alt="Suclogger Alipay"/>
        <p>Alipay</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/blockchain/" rel="tag"># blockchain</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/a-not-running-runnable/" rel="next" title="从锁死的RUNNABLE线程谈UNIX的I/O模型">
                <i class="fa fa-chevron-left"></i> 从锁死的RUNNABLE线程谈UNIX的I/O模型
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          

  
    <div class="comments" id="comments">
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Suclogger</p>
              <p class="site-description motion-element" itemprop="description">人生如逆旅，我亦是行人</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">53</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">7</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">33</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          
          

          
          

          
            
          
          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#为何关注区块链？"><span class="nav-number">1.</span> <span class="nav-text">为何关注区块链？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#区块链核心技术"><span class="nav-number">2.</span> <span class="nav-text">区块链核心技术</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#密码学"><span class="nav-number">2.1.</span> <span class="nav-text">密码学</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#对称加密：可靠信道"><span class="nav-number">2.1.1.</span> <span class="nav-text">对称加密：可靠信道</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#非对称加密：公钥公开"><span class="nav-number">2.1.2.</span> <span class="nav-text">非对称加密：公钥公开</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#公钥加密的场景：加密通信"><span class="nav-number">2.1.2.1.</span> <span class="nav-text">公钥加密的场景：加密通信</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#私钥加密的场景：身份认证"><span class="nav-number">2.1.2.2.</span> <span class="nav-text">私钥加密的场景：身份认证</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#HASH"><span class="nav-number">2.1.3.</span> <span class="nav-text">HASH</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#应用：计算机通信领域的HTTPS加密通道设计"><span class="nav-number">2.1.4.</span> <span class="nav-text">应用：计算机通信领域的HTTPS加密通道设计</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#区块链应用"><span class="nav-number">2.1.5.</span> <span class="nav-text">区块链应用</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#身份认证"><span class="nav-number">2.1.5.1.</span> <span class="nav-text">身份认证</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#数据校验，交易查找"><span class="nav-number">2.1.5.2.</span> <span class="nav-text">数据校验，交易查找</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#分布式共识"><span class="nav-number">2.2.</span> <span class="nav-text">分布式共识</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#PBFT"><span class="nav-number">2.2.1.</span> <span class="nav-text">PBFT</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#PoW"><span class="nav-number">2.2.2.</span> <span class="nav-text">PoW</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#PoS"><span class="nav-number">2.2.3.</span> <span class="nav-text">PoS</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#DPoS"><span class="nav-number">2.2.4.</span> <span class="nav-text">DPoS</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#基于以太坊开发一个简单的DApp：选举"><span class="nav-number">3.</span> <span class="nav-text">基于以太坊开发一个简单的DApp：选举</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#环境准备"><span class="nav-number">3.1.</span> <span class="nav-text">环境准备</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Coding"><span class="nav-number">3.2.</span> <span class="nav-text">Coding</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-初始化示例项目pet-shop"><span class="nav-number">3.2.1.</span> <span class="nav-text">1. 初始化示例项目pet-shop</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-编写智能合约"><span class="nav-number">3.2.2.</span> <span class="nav-text">2. 编写智能合约</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-编译和准备部署脚本"><span class="nav-number">3.2.3.</span> <span class="nav-text">3. 编译和准备部署脚本</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-创建用户接口和智能合约交互"><span class="nav-number">3.2.4.</span> <span class="nav-text">4. 创建用户接口和智能合约交互</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-部署合约，运行用户界面"><span class="nav-number">3.2.5.</span> <span class="nav-text">5. 部署合约，运行用户界面</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#推荐阅读"><span class="nav-number">4.</span> <span class="nav-text">推荐阅读</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Suclogger</span>

  

  
</div>


  



  <div class="powered-by">Powered by <a class="theme-link" target="_blank" rel="external nofollow" href="https://hexo.io">Hexo</a> v3.7.1</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" rel="external nofollow" href="https://github.com/theme-next/hexo-theme-next">NexT.Muse</a> v6.2.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="//cdn.jsdelivr.net/jquery/2.1.3/jquery.min.js"></script>
  

  
  
    <script type="text/javascript" src="//cdn.jsdelivr.net/velocity/1.2.3/velocity.min.js"></script>
  

  
  
    <script type="text/javascript" src="//cdn.jsdelivr.net/velocity/1.2.3/velocity.ui.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.2.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.2.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.2.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.2.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.2.0"></script>



  

  
    <script id="dsq-count-scr" src="https://suclogger.disqus.com/count.js" async></script>
  

  
    <script type="text/javascript">
      var disqus_config = function () {
        this.page.url = 'https://suclogger.me/beginning-blockchain/';
        this.page.identifier = 'beginning-blockchain/';
        this.page.title = '初识区块链';
      };
      function loadComments () {
        var d = document, s = d.createElement('script');
        s.src = 'https://suclogger.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      }
      
        $(function () {
          var offsetTop = $('#comments').offset().top - $(window).height();
          if (offsetTop <= 0) {
            // load directly when there's no a scrollbar
            loadComments();
          } else {
            $(window).on('scroll.disqus_scroll', function () {
              var scrollTop = document.documentElement.scrollTop;
              if (scrollTop >= offsetTop) {
                $(window).off('.disqus_scroll');
                loadComments();
              }
            });
          }
        });
      
    </script>
  





	





  












  





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  
  

  

  

  

  

  

</body>
</html>
